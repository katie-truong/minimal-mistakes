---
layout: single
title: "Explore the World of Pokemons using ggplot2 and plotly"
description: "My attempt to make interactive plots using dplyr, ggplot2 and plotly"
category: R
tags: [r, pokemon, plotly, ggplot2, interactive, dplyr, tidyr]
comments: true
---

Interactive plots made by `D3.js`, as useful and exciting as they look, are very daunting for the beginning users. However, recently, I have discovered a more light-weight alternative to `D3`, especially if you are already familiar with `ggplot2`, `plotly`. Although `plotly` can't totally replace `D3` for complicated works (thus `D3` is still a very highly sought after skill), it can do amazing jobs with simple interactive plots. In this post, I will analyze the [Pokemon dataset](https://www.kaggle.com/abcsds/pokemon) with 800 different pokemons and use `ggplot2` and `plotly` for interactive visualizations. 

To use `plotly` in R, first you need to follow [this guide](https://plot.ly/r/getting-started/) to set up (`plotly` also supports a variety of languages including Python, so feel free to choose the language of your choice).

## Preliminary steps

First, we need to load the file from the source, and load all the libraries we would use in the analysis:

```
pokemons_wide <- read.csv("Pokemon.csv")
library(ggplot2)
library(plotly)
library(dplyr)
library(tidyr)
library(scales)
library(reshape2)
library(ggthemes)
```

Using the `str` function for the dataset, we can see the very clean and straightforward structure of the dataset:

```
str(pokemons_wide)

'data.frame':	800 obs. of  13 variables:
 $ X.        : int  1 2 3 3 4 5 6 6 6 7 ...
 $ Name      : Factor w/ 800 levels "Abomasnow","AbomasnowMega Abomasnow",..: 81 330 746 747 103 104 100 101 102 666 ...
 $ Type.1    : Factor w/ 18 levels "Bug","Dark","Dragon",..: 10 10 10 10 7 7 7 7 7 18 ...
 $ Type.2    : Factor w/ 19 levels "","Bug","Dark",..: 15 15 15 15 1 1 9 4 9 1 ...
 $ Total     : int  318 405 525 625 309 405 534 634 634 314 ...
 $ HP        : int  45 60 80 80 39 58 78 78 78 44 ...
 $ Attack    : int  49 62 82 100 52 64 84 130 104 48 ...
 $ Defense   : int  49 63 83 123 43 58 78 111 78 65 ...
 $ Sp..Atk   : int  65 80 100 122 60 80 109 130 159 50 ...
 $ Sp..Def   : int  65 80 100 120 50 65 85 85 115 64 ...
 $ Speed     : int  45 60 80 80 65 80 100 100 100 43 ...
 $ Generation: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Legendary : Factor w/ 2 levels "False","True": 1 1 1 1 1 1 1 1 1 1 ...
 
```

 
 The dataset has 800 rows (yes, 800 different pokemons!) with 13 basic variables including their IDs, names, types, stats, generation and whether if they are legendary pokemons or not. Looking at the source, each column is explained as followed:
 
 
    #: ID for each pokemon
    Name: Name of each pokemon
    Type 1: Each pokemon has a type, this determines weakness/resistance to attacks
    Type 2: Some pokemon are dual type and have 2
    Total: sum of all stats that come after this, a general guide to how strong a pokemon is
    HP: hit points, or health, defines how much damage a pokemon can withstand before fainting
    Attack: the base modifier for normal attacks (eg. Scratch, Punch)
    Defense: the base damage resistance against normal attacks
    SP Atk: special attack, the base modifier for special attacks (e.g. fire blast, bubble beam)
    SP Def: the base damage resistance against special attacks
    Speed: determines which pokemon attacks first each round


One thing we can notice from the dataset is that there two main types of pokemons, Single type and Dual type. We can sort the pokemons into these two types by using the `ifelse` function:


```
pokemons_wide$Sort <- ifelse(pokemons_data$Type.2 == "", "Single", "Dual")
```

Another step we should do is to melt **Type.1** and **Type.2** into one column as **Type** for easier analysis in the next section and rearrange the dataset into a nice, usable format. We can achieve that easily by using `dplyr` and `tidyr`:

```
# Sort into Single or Dual Type
pokemons_wide$Sort <- ifelse(pokemons_data$Type.2 == "", "Single", "Dual")

# Melt Type1 and Type2 into Type
pokemons_long <- gather(pokemons_wide, Category, Type, 
                   Type.1, Type.2, factor_key = T)

# Convert to tbl_df
pokemons_long <- tbl_df(pokemons)

# Deselect the empty type 2
pokemons_long <- filter(pokemons_long, Type != "")

# Order by Poke number
pokemons_long <- pokemons_long[order(pokemons_long$X., pokemons_long$Category), ]

# Select usable columns
pokemons_long <- select(pokemons_long, Name, Type, Sort, Total:Legendary)
```

Which would give us a nice, clean long dataframe of 1214 rows and 12 columns:

```
> pokemons_long
Source: local data frame [1,214 x 12]

                    Name   Type   Sort Total    HP Attack Defense Sp..Atk Sp..Def Speed Generation Legendary
                  (fctr)  (chr)  (chr) (int) (int)  (int)   (int)   (int)   (int) (int)      (int)    (fctr)
1              Bulbasaur  Grass   Dual   318    45     49      49      65      65    45          1     False
2              Bulbasaur Poison   Dual   318    45     49      49      65      65    45          1     False
3                Ivysaur  Grass   Dual   405    60     62      63      80      80    60          1     False
4                Ivysaur Poison   Dual   405    60     62      63      80      80    60          1     False
5               Venusaur  Grass   Dual   525    80     82      83     100     100    80          1     False
6  VenusaurMega Venusaur  Grass   Dual   625    80    100     123     122     120    80          1     False
7               Venusaur Poison   Dual   525    80     82      83     100     100    80          1     False
8  VenusaurMega Venusaur Poison   Dual   625    80    100     123     122     120    80          1     False
9             Charmander   Fire Single   309    39     52      43      60      50    65          1     False
10            Charmeleon   Fire Single   405    58     64      58      80      65    80          1     False
..                   ...    ...    ...   ...   ...    ...     ...     ...     ...   ...        ...       ...
```

In this analysis, we would be working on both the origional **pokemons_wide** and the gathered format **pokemons_long**, depends on the task we are doing.

## Basic summary

### On the whole dataset:

Before doing any deep analysis, we can pull out the summary of basic statistics using function `summary` on the origional **pokemons_long**, which would give us a few interesting observations:

- There are 800 pokemons, into 18 different types.
- The minimum total point a pokemon can have is 180, while the maximum is 180. Mean and median are 435.1 and 450, respectively.
- There are a total of 6 generations, with a mean of 3.32 and a median of 3.
- There are 65 legendary pokemons.

### Per type:

Thanks to how `dplyr` works, we can easily get the basic statistics, per type, using only two functions:

```
byType <- group_by(pokemons_long, Type)
summaryStats_byType <- summarise(byType,
                                 count = n(),
                                 averageTotal = mean(Total, na.rm = T),
                                 averageGeneration = mean(Generation, na.rm = T),
                                 legendaryCount = sum(as.character(Legendary) == "True"))
```

Which gives us:

```
        Type count averageTotal medianGeneration legendaryCount
      (chr) (int)        (dbl)            (dbl)          (int)
1       Bug    72     379.5278                3              0
2      Dark    51     460.9020                4              3
3    Dragon    50     541.7600                4             16
4  Electric    50     444.8400                4              5
5     Fairy    40     415.9250                3              3
6  Fighting    53     470.1132                4              4
7      Fire    64     467.1094                3              8
8    Flying   101     453.8317                3             15
9     Ghost    46     436.8696                5              3
10    Grass    95     417.9263                4              3
11   Ground    67     441.0746                3              5
12      Ice    38     467.4474                4              5
13   Normal   102     402.0686                3              2
14   Poison    62     397.6935                1              0
15  Psychic    90     477.0889                3             19
16     Rock    58     449.1379                3              4
17    Steel    49     486.5918                4              5
18    Water   126     429.0952                3              5
```

<iframe width="770" height="400" frameborder="0" scrolling="no" src="https://plot.ly/~estnnk/20.embed"></iframe>
